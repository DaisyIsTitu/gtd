# Product Requirements Document (PRD)
# Todo Time-blocking 앱

## 1. 개요

### 1.1 제품 비전
Google Calendar와 연동하여 할 일을 자동으로 최적의 시간에 배치해주는 스마트 시간 관리 웹 애플리케이션

### 1.2 핵심 가치 제안
- **자동 스케줄링**: 할 일만 추가하면 애플리케이션이 Google Calendar의 빈 시간을 분석하여 자동 배치
- **시각적 시간 관리**: 캘린더 뷰를 통한 직관적인 시간 블록 관리
- **스마트 분할**: 긴 할 일을 적절한 크기로 분할하여 여러 시간대에 배치
- **놓친 할 일 재배치**: 시간이 지난 할 일을 자동으로 감지하여 우선순위로 재배치
- **유연한 조정**: 언제든지 드래그앤드롭으로 일정 수정 가능

### 1.3 타겟 사용자
- 업무와 개인 일정을 체계적으로 관리하고 싶은 직장인
- Google Calendar를 이미 사용 중인 사용자
- 시간 관리에 어려움을 겪는 개인 사용자

## 2. 핵심 기능

### 2.1 Todo 관리 시스템

#### 2.1.1 Todo 입력
- **필수 필드**
  - 제목 (텍스트)
  - 소요시간 (사용자 입력, 기본값: 2시간)
  - 카테고리 (업무/개인)
- **선택 필드**
  - 상세설명 (텍스트 에어리어)
  - 데드라인 (날짜/시간)
  - 태그 (다중 선택 가능)
  - 우선순위 (높음/보통/낮음)

#### 2.1.2 Todo 상태 관리
- **대기중**: 아직 배치되지 않은 상태
- **배치됨**: 캘린더에 자동 배치된 상태
- **분할됨**: 긴 할 일이 여러 부분으로 나뉜 상태
- **진행중**: 사용자가 "시작" 버튼을 클릭한 상태
- **놓친 할 일**: 배치된 시간이 종료된 후 30분 경과했지만 시작하지 않은 상태
- **완료**: 작업이 완료된 상태

#### 2.1.3 놓친 할 일 처리 로직
```
시간 기반 자동 상태 전환:
1. 할 일의 배치된 종료 시간 + 30분 경과 시
2. "배치됨" → "놓친 할 일" 상태로 자동 변경
3. 다음 "자동 배치" 실행 시 놓친 할 일들을 우선순위 +1 부스트하여 재배치
4. 사용자가 수동으로 "놓친 할 일" 상태를 "대기중"으로 변경 가능
```

### 2.2 캘린더 인터페이스

#### 2.2.1 메인 뷰 - 주간 캘린더
- **시간대**: 오전 10시 ~ 오후 8시 (업무시간대 중심)
- **Google Calendar 연동**: 기존 일정 표시
- **Todo 일정 표시**: 배치된 Todo를 캘린더에 시각화
- **색상 구분**: 카테고리별 색상으로 구분
  - 업무: 파란색 계열
  - 개인: 초록색 계열
  - 놓친 할 일: 주황색 계열
- **분할 표시**: 분할된 할 일은 "할 일명 (1/3)" 형태로 표시
- **상태별 표시**: 진행중인 할 일은 진한 색상, 완료된 할 일은 연한 색상

#### 2.2.2 사이드바 - Todo 리스트
- **배치되지 않은 Todo 표시**
- **놓친 할 일 섹션** (주황색 구분선으로 분리)
- 카테고리별 그룹핑
- 태그별 필터링 기능
- 우선순위별 정렬 기능 (놓친 할 일은 +1 부스트 표시 ⭐)
- 상세설명 미리보기 (첫 2줄)

### 2.3 스마트 스케줄링 시스템

#### 2.3.1 스케줄링 트리거
- **수동 실행**: 사용자가 "일정 자동 배치" 버튼 클릭 시
- Google Calendar 빈 시간 실시간 분석
- 업무시간대(10AM-8PM) 내에서 최적 시간 탐색
- 놓친 할 일들도 함께 재배치 처리

#### 2.3.2 빈 시간 분석 로직
```
1. Google Calendar에서 업무시간대(10AM-8PM) 내 모든 기존 일정 수집
2. 시간 슬롯을 30분 단위로 분할하여 가용시간 매트릭스 생성
3. 연속된 빈 시간 블록들을 크기순으로 정렬
4. 최소 배치 가능 시간(30분) 이상인 블록들만 필터링
```

#### 2.3.3 Todo 분할 배치 로직
```
IF 소요시간 > 연속 가능한 최대 빈 시간:
  1. Todo를 최대 4시간 단위로 분할 (집중력 고려)
  2. 각 분할된 부분을 별도 일정으로 생성
  3. "할 일명 (1/3)", "할 일명 (2/3)" 형태로 제목 생성
  4. 원본 Todo에 "분할됨" 상태 표시
  5. 분할된 각 부분은 원본 Todo와 연결 관계 유지
```

#### 2.3.4 배치 우선순위 알고리즘
```
1. 놓친 할 일: 최우선 배치 (기존 우선순위 +1 부스트)
2. 데드라인 있는 Todo: 데드라인 역순으로 우선 배치
3. 우선순위 높음: 가장 큰 빈 시간 블록에 우선 배치
4. 소요시간 긴 것: 큰 블록부터 배치 (테트리스 방식)
5. 같은 카테고리: 2시간 이내 간격으로 인접 배치 시도
```

#### 2.3.5 충돌 해결 로직
```
배치 시도 중 충돌 발생 시:
1. 기존 Google 일정과 충돌: 다음 가능한 시간으로 이동
2. 이미 배치된 Todo와 충돌: 우선순위 비교 후 재배치
3. 분할이 필요한 경우: 자동 분할 후 최적 시간에 배치
4. 배치 불가능한 경우: 사용자에게 알림 및 수동 조정 요청
```

### 2.4 수정 및 조정 기능

#### 2.4.1 드래그앤드롭 편집
- 캘린더 내에서 Todo 일정의 시간/날짜 변경
- 소요시간 조정 (드래그로 블록 크기 조정)
- 실시간 충돌 감지 및 알림
- 분할된 할 일의 개별 조정 가능

#### 2.4.2 수동 편집
- Todo 세부사항 수정 (제목, 상세설명, 카테고리, 태그 등)
- 일정 삭제 및 재배치
- 상태 수동 변경 (시작/완료 토글)
- 분할된 할 일 통합 기능
- "놓친 할 일"을 "대기중"으로 되돌리기

#### 2.4.3 할 일 진행 관리
- **시작 버튼**: 배치된 할 일을 "진행중" 상태로 변경
- **완료 버튼**: "진행중" 또는 "배치됨" 상태를 "완료"로 변경
- **일시정지**: "진행중" 상태를 "배치됨"으로 되돌리기

## 3. 분류 시스템

### 3.1 카테고리
- **업무**: 직장 관련 업무, 회의, 프로젝트 등
- **개인**: 개인적인 할 일, 취미, 자기계발 등

### 3.2 태그 시스템
- 각 카테고리 내에서 세부 분류
- 예시 태그:
  - 업무: #회의, #개발, #기획, #보고서, #이메일
  - 개인: #운동, #독서, #쇼핑, #약속, #취미

## 4. 기술 요구사항

### 4.1 플랫폼
- **웹 애플리케이션**: 데스크톱 브라우저 우선 지원
- 반응형 디자인으로 태블릿 호환성 확보

### 4.2 외부 연동
- **Google Calendar API**: 읽기/쓰기 권한 필요
- OAuth 2.0 인증을 통한 안전한 연동
- 실시간 캘린더 동기화

### 4.3 데이터 저장
- 사용자별 Todo 데이터 저장
- 태그 및 카테고리 설정 저장
- 분할된 할 일 간의 연결 관계 저장
- 할 일 상태 변경 이력 저장 (놓친 할 일 추적)
- 사용자의 스케줄링 패턴 학습 데이터

### 4.4 알고리즘 성능
- 빈 시간 분석: 1초 이내 완료
- Todo 배치 처리: 10개 할 일 기준 3초 이내
- 실시간 충돌 감지: 즉시 반응
- 놓친 할 일 자동 상태 변경: 백그라운드에서 5분마다 체크

## 5. 사용자 시나리오

### 5.1 기본 사용 플로우
1. 사용자가 Google 계정으로 로그인
2. "새 할 일" 버튼 클릭하여 Todo 추가
3. 제목, 소요시간, 카테고리, 상세설명 입력
4. "일정 자동 배치" 버튼 클릭
5. 애플리케이션이 Google Calendar 빈 시간을 분석하여 최적 시간에 배치
6. 필요시 긴 할 일을 자동으로 분할하여 여러 시간대에 배치
7. 사용자가 할 일 시간에 "시작" 버튼 클릭하여 "진행중" 상태로 변경
8. 작업 완료 후 "완료" 버튼으로 완료 상태 변경

### 5.2 놓친 할 일 처리 시나리오
1. 사용자가 오후 2-4시에 배치된 "보고서 작성"을 시작하지 않음
2. 오후 4시 30분이 되면 자동으로 "놓친 할 일" 상태로 변경
3. 사이드바의 "놓친 할 일" 섹션에 주황색으로 표시
4. 다음 날 "자동 배치" 실행 시 우선순위 +1 부스트되어 우선 배치
5. 사용자가 필요시 "놓친 할 일"을 "대기중"으로 수동 변경 가능

### 5.3 분할 배치 시나리오
1. 사용자가 "프로젝트 개발" 할 일을 10시간으로 설정
2. 자동 배치 실행 시 애플리케이션이 연속된 빈 시간이 최대 4시간임을 감지
3. 자동으로 "프로젝트 개발 (1/3)" 4시간, "프로젝트 개발 (2/3)" 4시간, "프로젝트 개발 (3/3)" 2시간으로 분할
4. 각각 다른 날짜/시간의 가용한 블록에 배치
5. 사용자가 개별 분할 부분의 시간 조정 및 개별 시작/완료 관리 가능